import React from 'react';
import { Matcher } from 'interweave';

declare module 'interweave' {
  declare export type ReactNode<T> = string | React.Element<T>;

  declare export type ReactNodeList<T> = ReactNode<T>[];

  declare export type AfterParseCallback = (content: ReactNodeList<*>, props: Object) => ReactNodeList<*>;

  declare export type BeforeParseCallback = (content: string, props: Object) => string;

  declare export class Filter {
    attribute: string;
    constructor(attribute: string): this;
    filter(value: string): string;
  }

  declare export type MatcherFactory = (match: string, props: Object) => ReactNode<*>;

  declare export class Matcher<T> {
    factory: ?MatcherFactory;
    inverseName: string;
    options: T;
    propName: string;
    constructor(name: string, options?: T, factory?: ?MatcherFactory): this;
    createElement(match: string, props?: Object): ReactNode<*>;
    replaceWith(match: string, props?: Object): ReactNode<*>;
    asTag(): string;
    match(string: string): ?{
      match: string,
      [key: string]: any,
    };
    onAfterParse(content: ReactNodeList<*>, props: Object): ReactNodeList<*>;
    onBeforeParse(content: string, props: Object): string;
  }

  declare export type MarkupProps = {
    content: string,
    disableLineBreaks: boolean,
    disableWhitelist: boolean,
    emptyContent: ?ReactNode<*>,
    noHtml: boolean,
    noHtmlExceptMatchers: boolean,
    tagName: string,
  };

  declare export class Markup extends React.Component<MarkupProps> {}

  declare export type InterweaveProps = {
    content: string,
    disableFilters: boolean,
    disableLineBreaks: boolean,
    disableMatchers: boolean,
    disableWhitelist: boolean,
    emptyContent: ?ReactNode<*>,
    filters: Filter[],
    matchers: Matcher<*>[],
    noHtml: boolean,
    noHtmlExceptMatchers: boolean,
    onAfterParse: AfterParseCallback,
    onBeforeParse: BeforeParseCallback,
    tagName: string,
  };

  declare export default class Interweave extends React.Component<InterweaveProps> {
    parseMarkup(): ReactNodeList<*>;
    render(): ReactNode<*>;
  }
}

declare module 'interweave/lib/components' {
  declare export class Element extends React.Component {}
  declare export class Email extends React.Component {}
  declare export class Emoji extends React.Component {}
  declare export class Hashtag extends React.Component {}
  declare export class Link extends React.Component {}
  declare export class Url extends React.Component {}
}

declare module 'interweave/lib/matchers' {
  declare export class EmailMatcher extends Matcher<Object> {}
  declare export class EmojiMatcher extends Matcher<Object> {}
  declare export class HashtagMatcher extends Matcher<Object> {}
  declare export class IpMatcher extends Matcher<Object> {}
  declare export class UrlMatcher extends Matcher<Object> {}
}
